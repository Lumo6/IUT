/*Création de la base de données*/

drop table if exists Marquer;
drop table if exists Appartenir ;
DROP TABLE IF EXISTS  Equipes;
drop table if exists Matchs;
drop table if exists Associer;
drop table if exists Joueurs ;
drop table if exists Tournois;
drop table if exists Terrains  ;
drop table if exists Sports;
drop table if exists Poules;
drop table if exists Arbitres;


CREATE TABLE Joueurs (
    id_joueur int,
    nom_joueur varchar(55),
    point int,
    CONSTRAINT pk_Joueurs PRIMARY KEY  (id_joueur));


CREATE TABLE Tournois
(
n_T int ,
dateD DATE,
dateF DATE,
CONSTRAINT pk_tournois PRIMARY KEY (n_T)
)
;


CREATE TABLE Arbitres(
num_A INT,
nom_A VARCHAR(200),
CONSTRAINT Arbitre_PK PRIMARY KEY(num_A)
);

CREATE TABLE Terrains (
    nTerrain int,
    Designation varchar(100),
    CONSTRAINT terrain PRIMARY KEY (nTerrain));



CREATE TABLE Sports(
id_S INT,
nom_S VARCHAR(20),
nb_joueur_max INT,
nb_joueur_min INT,
CONSTRAINT PK_Sport PRIMARY KEY(id_s)
) ;



CREATE TABLE Poules(
    numPoules INT,
    designation VARCHAR(100),
CONSTRAINT PK_Poules PRIMARY KEY (numPoules)

);



CREATE TABLE Equipes(
numEq int,
nomEq varchar(50),
n_T int,
numPoules int,
id_S int,
     CONSTRAINT PK_Equipes PRIMARY KEY (numEq),
            CONSTRAINT FK_Equipes_Tournois FOREIGN KEY (n_T) REFERENCES Tournois(n_T),
            CONSTRAINT FK_Equipes_Poules FOREIGN KEY (numPoules) REFERENCES Poules(numPoules),
            CONSTRAINT FK_Equipes_Sports FOREIGN KEY (id_S) REFERENCES Sports(id_S));





CREATE TABLE Matchs(
    num_A INT,
    num_match INT,
    heureDepart DATE,
    heureFin DATE,
    nTerrain INT,
    numEq1 INT,
    numEq2 INT,
    CONSTRAINT PK_Matchs PRIMARY KEY(num_Match),
    CONSTRAINT FK_Matchs_Arbitre FOREIGN KEY(num_A) REFERENCES Arbitres(num_A),
    CONSTRAINT FK_Matchs_Terrains FOREIGN KEY(nTerrain) REFERENCES Terrains(nTerrain),
    CONSTRAINT FK_Matchs_Equipes FOREIGN KEY(numEq1) REFERENCES Equipes(numEq),
    CONSTRAINT FK_Matchs_Equipes2 FOREIGN KEY(numEq2) REFERENCES Equipes(numEq)
);






CREATE TABLE Associer(
id_S INT,
nTerrain INT,
CONSTRAINT Associer_Sport_FK FOREIGN KEY(id_S) REFERENCES Sports(id_S),
CONSTRAINT Associer_Terrains_FK FOREIGN KEY(nTerrain) REFERENCES Terrains(nTerrain));


CREATE TABLE Appartenir (
    id_joueur int,
    numEq int,
    CONSTRAINT pk_Appartenir PRIMARY KEY  (id_joueur,numEq),
    CONSTRAINT fk_Appartenir FOREIGN KEY (numEq) REFERENCES Equipes (numEq),
    CONSTRAINT fk_Appartenir2 FOREIGN KEY (id_joueur) REFERENCES Joueurs (id_joueur));







CREATE TABLE Marquer
(
nombrePoint INT,
Temps INT,
id_joueur INT,
num_match INT,
CONSTRAINT FK_marquer FOREIGN KEY(id_joueur)
    REFERENCES Joueurs(id_joueur),
CONSTRAINT FK_marquer2 FOREIGN KEY (num_match)
REFERENCES Matchs(num_match),
CONSTRAINT PK_marquer PRIMARY KEY (id_joueur, num_match)
)
;


INSERT INTO Tournois (dateD, dateF, n_T)VALUES
('2023-09-01', '2023-10-01', '1'),
('2023-10-01', '2023-11-01', '2'),
('2023-11-01', '2023-12-01', '3'),
('2023-08-01', '2023-09-01', '4');


INSERT INTO Terrains (nTerrain, Designation) VALUES
('1', 'Football'),
('2', 'Basket'),
('3', 'Tennis de table'),
('4', 'Badminton');

INSERT INTO Arbitres (num_A, nom_A) VALUES
('1', 'Gilbert Montagné'),
('2', 'Stevie Wonder'),
('3', 'Ray Charles'),
('4', 'Louis Braille'),
('5', 'Blind Willie Johnson'),
('6', 'Nobuyuki Tsujii'),
('7', 'Pierre Deljan'),
('8', 'André Marchal');

